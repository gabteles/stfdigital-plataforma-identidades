sudo: required
language: java
jdk:
- oraclejdk8
services:
- docker
addons:
  hosts:
  - docker
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
- docker save -o $HOME/docker_cache/docker.tar stfdigital-plataforma-userauthentication $(docker history -q stfdigital-plataforma-userauthentication | tail -n +2 | grep -v \<missing\> | tr '\n' ' ')
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - node_cache
  - node_modules
  - "$HOME/docker_cache"
before_install:
- "./scripts/upgrade-docker.sh"
- mkdir -p $HOME/docker_cache
install: docker load -i $HOME/docker_cache/docker.tar || true
script: gradle docker && gradle gulpTestUnit && ./scripts/test-e2e.sh
notifications:
  slack:
    secure: iuMsywvOvKw0LIqm3P6aLzA3jPrrMnxOC5fXfBSp2AgQGDnz211kW2VVpaKK/5WV4yJ4dnGHm2TSJYl4+ODbcQ1Te9Vhpl2drEq3FkCuwrCze4hgGSzIs4DyYLeFO7UVmdAHwXohN9pgqr4twRr0ImSQZ6uXfGJNMpiPh1xUPLCeiY6jy2Hy7s3jejjsWnzLcNtP0hytL83oTIrnk1VFab5jkWBaZLEw6SCZFlilzLb2Ztku1AYChjmnMxrYdr+Bc1tPH3S1EmW1txRhpoELYsu+ZG9oZzFm0HY9s0m21n2QAPDluHAAyMlP9HtBaoIP9c4xbgGx0Vk87hXLHFI7p76sVLy5g6vFVjcMxqh3WEKQX5WaYMJ8OkjfKyzZE0mngA9OJOTz41B7MtzLVGWn0ENA5wnh5Vf4hHT1SC0G7S6fjWXsFhYDF2f2fHQj5kOOjiaktYdqMFwmyRHjAXBKvs8VXVHcf1qCZY+ZLJVow2iMKXEF9Bs5ekcV0rlD0tAWJqq9zDPQPEtnj4mkDMG4Q16byPeKFYozEIBMSEdC+RAJmdvYC1EyKcojY0VnACB+6xTzLos0bf356PdHhG8Jh/ApPke4ATkFF1yKLrB/xhTl2Lq0TVUMCzEvxQrOZxDiXo9XGJf6seo5JXq+OPMfZVB0u9ZHoqvxqkXY3cmuJrc=
